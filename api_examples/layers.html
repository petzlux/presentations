<html>
    <head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>GeoAPI Exemple</title>
<link rel="stylesheet" type="text/css" href="http://api.geoportail.lu/build/latest/ext-all.css" />
<link rel="stylesheet" type="text/css" href="http://api.geoportail.lu/build/latest/xtheme-gray.css" />
<link rel="stylesheet" type="text/css" href="http://api.geoportail.lu/build/latest/api.css" />
<link rel="stylesheet" type="text/css" href="http://api.geoportail.lu/build/latest/MapFishApi_api.css" />
<link rel="stylesheet" type="text/css" href="http://api.geoportail.lu/build/latest/geoadmin.css" />
<script type="text/javascript" src="http://api.geoportail.lu/build/latest/ext-base.js"></script>
<script type="text/javascript" src="http://api.geoportail.lu/build/latest/ext-all.js"></script>
<script type="text/javascript" src="http://api.geoportail.lu/build/latest/geoadmin.js"></script>
<script type="text/javascript" src="http://api.geoportail.lu/api.js"></script>


</head>
<body>
    <div id='map'/>
 </body>
 <script type="text/javascript">

    Ext.onReady( function init() {
		lux = new OpenLayers.Projection("EPSG:2169"); // the luxembourg coordinate reference system 
		wgs = new OpenLayers.Projection("EPSG:4326"); // the WGS84 coordinate reference system
		lonLat = new OpenLayers.LonLat(6.12459923192738, 49.6188206257115 ).transform( wgs, lux );
		
		geo = new geoadmin.API({lang: 'fr'});
		var mapPanel = geo.createMapPanel({
			mapInfo: {
				zoom: 4,
				easting: lonLat.lon,
				northing: lonLat.lat,
				bgLayer: 'streets',
				bgOpacity: 100 
			}
		});

	geo.searchUrl="http://api.geoportail.lu/locationsearch"; 
    var toolbar = geo.createToolbar(["MapOpacity"]);
    var mapWindow = Ext.apply(mapPanel, {tbar: toolbar});
    var layerTree = geo.createLayerTree();

	geo.addLayerToMap('addresses');
	geo.map.getLayersBy('layername','addresses')[0].setVisibility(false);
	geo.addLayerToMap('arrets_bus');
	geo.map.getLayersBy('layername','arrets_bus')[0].setVisibility(true);

	geo.createTooltipFeature({
		tooltipUrl:'http://map.geoportail.lu/bodfeature/search',
		requestOnlyVisibleLayers:true
	});
 	
 	var panel = new Ext.Panel({
		id: "geoAPIPanel",
		layout: "border",
		renderTo: "map",
		height: 400,
		width: 960,
		items: 	[	Ext.apply(mapWindow, {region: "center"}), 
					Ext.apply(layerTree, {region: "west", width: 280}) 	
				]
	})	

    var viewPort = new Ext.Viewport({
        renderTo: Ext.getBody(),
        layout: "fit",
			items:  [ 	Ext.apply(panel,{region: "center"})]
        });
    });


 </script>    
</html>

